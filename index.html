<!DOCTYPE html>
<html>
  <head>
    <title>AR Restroom Locator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.2/aframe/build/aframe-ar.min.js"></script>
    <link rel="icon" href="data:," />
    <style>
      .distance-label {
        position: fixed;
        bottom: 20px; width: 100%; text-align: center;
        font-size: 1.5em; color: white;
        background: rgba(0,0,0,0.5); padding: 10px; z-index: 10;
      }
    </style>
  </head>
  <body style="margin:0; overflow:hidden">
    <a-scene embedded arjs="sourceType: webcam; detectionMode: mono;" vr-mode-ui="enabled: false">
      <a-marker preset="hiro">
        <a-box id="arrow" position="0 1 -2" color="#00B78E" depth="2" height="0.5" width="0.5"></a-box>
      </a-marker>
      <a-entity camera></a-entity>
    </a-scene>

    <div class="distance-label" id="distanceLabel">Restroom: 30.4m ➤</div>

    <script>
      window.addEventListener("load", () => {
        const arrow = document.querySelector("#arrow");
        const label = document.getElementById("distanceLabel");
        const pos = { x: 30, y: 5 };
        const angleDeg = (Math.atan2(pos.y, pos.x) * 180) / Math.PI;
        const dist = Math.hypot(pos.x, pos.y);
        label.innerText = `Restroom: ${dist.toFixed(1)}m ➤`;

        window.addEventListener("deviceorientationabsolute", (ev) => {
          const h = ev.alpha;
          if (h !== null && arrow) {
            let rot = (angleDeg - h + 360) % 360;
            arrow.setAttribute("rotation", `0 ${rot.toFixed(1)} 0`);
          }
        }, true);
      });
    </script>
  </body>
</html>
